사전 지식

참고 : https://jeong-pro.tistory.com/80

쿠키와 세션

쿠키와 세션이 있는 이유는 무엇일까? 

HTTP는 클라이언트가 요청(request)을 서버에 보내고, 서버는 클라이언트에게 적절한 응답(response)을 주고 연결을 끊는 특성이 있다. 

이 가장 큰 장점은 서버 리소스 낭비가 줄어든다는 것이지만 

통신할 때마다 새로 커넥션을 만들기 때문에 클라이언트에게는 상태를 유지하기 위해 통신할 때마다 어떤 절차를 거쳐야한다는 단점이 생긴다. 



### 쿠키

쿠키는 클라이언트 로컬에 저장되는 키와 값이 들어있는 작은 데이터 파일이다. 

쿠키에는 이름, 값, 만료 날짜/시간(쿠기 저장기간), 경로 정보 등이 들어있다. 

쿠키는 클라이언트의 상태 정보를 로컬에 저장했다가 요청할 때 참조된다. 

쿠키는 서버측에서 만료 날짜/시간을 지정하여 정해진 시간 동안 데이터를 유지할 수 있다.(일정 시간 동안 로그인 상태가 유지된다.)



세션쿠키(Session Cookie)와 지속쿠키(Persistent Cookie)

만료 날짜/시간을 지정하지 않으면, '메모리에 있는 동안' 계속 유효하다고 판단하도록 세션 쿠키에 저장되고, 만료 날짜/시간을 지정하면 프로세스가 종료되더라도(메모리에서 사라지더라도) 특정 만료날짜/시간까지 유효하므로 지속 쿠키에 저장된다.

세션쿠키는 브라우저 메모리에 저장되므로 브라우저가 종료되면 쿠키는 사라지게 되고 

지속쿠키는 파일로 저장되므로 브라우저가 종료되어도 쿠키는 남아있게 된다. 



### 세션

서버에 클라이언트의 상태 정보를 저장하는 기술로 논리적인 연결을 세션이라고 한다. 

웹 서버에 클라이언트에 대한 정보를 저장하고 클라이언트에게는 클라이언트를 구분할 수 있는 ID를 부여하는데 이것을 세션ID라고 한다. 

세션 프로세스

+ 클라이언트가 서버에 요청했을 때, 필요에 따라 세션에 클라이언트에 대한 데이터를 저장하고 세션 아이디 응답을 통해 발급해준다. 
+ 클라이언트는 발급받은 세션 아이디를 쿠키로 저장한다. 
+ 클라이언트는 다시 서버에 요청할 때, 세션 아이디를 서버에 전달하여 상태 정보를 서버가 활용할 수 있도록 해준다. 



결과적으로 세션을 통해 클라이언트의 정보는 서버에 두고 세션 아이디를 이용해서 인증받고 정보를 이용하는 방식

+ 세션 사용 사례
  + 로그인 정보 유지 



## URLSession이란?

URLSession은 iOS에서 제공하는 HTTP를 이용한 네트워킹을 통해 데이터를 주고받을 수 있게 도와주는 API를 제공해주는 클래스이다. URLSession은 Thread-Safety하기 때문에 어떤 스레드에서든 자유롭게 Session과 Task를 생성할 수 있다. 



URLSession은 URLSessionConfiguration을 통해 생성할 수 있다. 이렇게 생성된 URLSession을 통해 한 개 이상의 URLSessionTask를 생성할 수 있으며, 이 URLSessionTask를 통해 실제로 서버와 통신을 할 수 있다. 



#### URLSessionConfiguration

+ Default: 기본적인 네트워킹 정책을 사용한다.(?)
+ Ephemeral: 쿠키와 캐시를 저장하지 않을 때 사용한다. (어떤 경우가 있을까?)
+ Background: 앱이 background에 있을 때 컨텐츠를 다운로드 혹은 업로드 할 때 사용한다. 



#### URLSessionTask

- URLSessionDataTask : 데이터를 받는 작업 수행 시 사용한다. background 세션에 대한 지원을 하지 않는다.
- URLSessionUploadTask : 데이터 업로드 시 사용
- URLSessionDownloadTask : 데이터 다운로드 시 사용





