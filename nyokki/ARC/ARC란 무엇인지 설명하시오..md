## ARC란?

ARC(Auto Reference Counting)



스택에 저장된 데이터는 자동으로 제거 되기 때문에 특별한 관리가 필요 없으나 

하지만 힙에 저장된 데이터는 필요하지 않은 시점에 직접 제거해야한다. 

메모리 관리모델은 힙에 저장된 데이터를 관리하는데 특히 클래스 인스턴스를 관리한다. 



Cocoa에서 사용하는 메모리 관리 모델은 MRC/ARC인데 Swift에서는 ARC만 제공한다. 

인스턴스는 하나 이상의 소유자가 있는 경우에 메모리에 유지된다. 

반대로 소유자가 없다면 메모리에서 제거된다. 

제거 시점을 파악하기 위해서 소유자 수를 저장하는데 이것을 참조 카운트라고 한다. 



인스턴스는 참조 카운트 1 이상이면 메모리에서 유지되고 참조 카운트가 0이되면 메모리에서 제거된다.

클래스 인스턴스를 변수에 저장하면 변수가 소유자가 되기에 참조 카운트가 1이 된다.

동일 인스턴스를 다른 변수에 저장하면 소유자가 늘어나기 때문에 참조 카운트가 2가 된다. 

인스턴스를 소유하기 위해서는 특별한 메세지를 전달해야 하는데 

코드레벨에서 확인하자면 인스턴스가 제공하는 retain 메서드 호출하는 것과 같다.

인스턴스가 더이상 필요하지 않다면 소유권을 포기해야하는데 이 메세지는 release 메소드 이다.

소유권을 포기하면 인스턴스 참조 카운트가 1 감소한다. 

이렇게 참조카운트가 0이되면 즉시 메모리에서 제거 된다. 



컴파일러가 메모리 관리 코드를 자동으로 작성해주기 때문에 

코드가 줄어들고 메모리 안전성이 증가한다. 





참고

https://www.notion.so/ARC-ced8ef568b2d429cb22e7ee05b54da72

https://velog.io/@grap_ios/%EB%A9%B4%EC%A0%91%EC%A7%88%EB%AC%B8-ARC-01-06

https://babbab2.tistory.com/26