# TCP/IP 프로토콜

우리 사용하는 스마트폰은 인터넷 연결이 끊기면 생활이 아주 불편하다. 그럼 우리가 유용하게 사용하고 있는 이 인터넷과 연결. 네트워킹은 어떻게 이루어질까? 

우리가 인터넷에서 받아오는 정보는 사실 다른 외부 컴퓨터에 접근하여 정보를 받아오거나 저장하는 일을 한다. 이때 컴퓨터/스마트폰은 클라이언트(고객)라고 칭하고 정보가 있는 컴퓨터를 서버라고 한다. 

그럼 둘이 어떻게 연결이 될까? 인터넷에 연결하는 방법은 다양한 프로토콜로 존재한다. 이를 통합해서 부르는 것을 TCP/IP라고 부른다. 여기서 프로토콜은 약속을 의미한다. 서로 연결하고 정보를 교환하기 위한 약속. 

우리가 중점적으로 알아야하는 프로토콜은 HTTP 프로토콜이다. 

# 요청과 응답의 방식(우편 주고 받기)

현재 인터넷의 모든 것은 HTTP로 이루어져있다. 

앱 개발을 하는 상황에서 애플리케이션에서 HTTP는 리퀘스트라고 한다. 서버와 통신을 하는 것은 편지/우편을 주고 받는 것과 유사하다. 편지를 쓰거나 문서를 보낼 때 우편에 작성하는 양식과 약속이 정해져 있듯이 정보를 요청하거나 서버에서 앱에 정보를 줄 때도 이 양식을 갖춰서 전송을 하게 된다. 

애플리케이션에 편지지인 HTTP를 작성하고 이를 OS에서 받게된다. OS의 트랜스포트에서 TCP로 바꾸는데 받은 HTTP를 조각내고 전송한 곳(카카오톡, 음악 앱, 사진 앱 등)의 표시를 하는 PORT를 붙힌다. 그리고 우편 주소를 적은 IP를 붙여준다. 

이를 LAN에서 받아 한번 더 감싼 뒤 서버로 보낸다. 이렇게 4개의 계층으로 이루어져있다. 



정리하면 HTTP는 데이터를 어떻게 주고 받을지에 대한 약속이며 요청과 응답이 이루어진다. 

TCP에서는 주고 받을 상태 확인과 검증을 하고 어떤 앱과 통신하는지를 밝히는 PORT를 붙인다. 그리고 인터넷에서 주고 받는 주소(경로)를 즉, IP 주소를 작성해준다. 

서버에서 이 요청을 받으면 역순으로 포장과 우편을 풀어서 내용을 확인하게 되며 서버에서 앱으로 정보를 전달할 때에도 동일한 4계층의 단계를 거치게 된다. 

# HTTP(Hyper Text Transfer Protocol)

하이퍼 문서를 전송하는 것에서 시작을 한 것을 HTTP 프로토콜이라고 한다. 역사의 시작은 문서를 보내는 것에서 시작을 했지만 지금은 이미지/영상/음성/파일/JSON 등 모든 형태의 데이터를 전송하는 것이 가능하다. 따라서 하이퍼 텍스트라고 칭하는 것이다. 

앱 개발자가 해줘야하는 일은 앱이 올바른 형식으로 정보를 요청하고 받아오는 작업을 하는 것이다. 올바른 형식이란 요청 메세지를  HTTP에 맞춰 올바르게 리퀘스트 하는 것이다. 

요청인 리퀘퀘스트는 Query라고 하고 응답인 Response는 data가 온다. 

## HTTP의 구조

한번 더 말하자면 HTTP 메세지 형태는 데이터를 어떻게 주고 받을지에 대한 약속을 말한다. 

메세지의 형식은 가장 위에서 부터 시작라인/헤더/  공 백  / 바디 순으로 되어있다. 

#### HTTP 요청 / 응답 메세지

<img src="https://blog.kakaocdn.net/dn/4g6c8/btqJRmEIaA9/7eygSadanLoc5FmWCwGZPK/img.png" alt="img" style="zoom: 50%;" />

1. 시작 라인 

   + 요청 메세지의 경우

     시작 라인에는 HTTP 메소드, 주소, HTTP 버전 순으로 되어있다. 

   + 응답 메세지의 경우

     HTTP 버전, 상태코드, 문구가 들어오는데 문구에는 상태코드에 대한 내용이다.

2. 헤더

   부가 정보가 들어간다. 실제로 필요한 정보는 바디에 들어있다. (요청/응답 메세지 동일)

3. 공백라인 

   정말 말 그대로 공백으로 되어있다. (요청/응답 메세지 동일)

4. 바디

   바디에는 실제로 전송할 데이터(JSON/ 이미지/ 영상/ HTML 문서 등)가 들어있다. (요청/응답 메세지 동일)

### HTTP 메소드

가장 잘 알아야하는 것은 GET, POST, PUT, PATCH, DELETE 이다. 

GET은 조회하는 것으로 카카오톡의 경우 현재까지 왔던 데이터를 불러오는 메소드이다. 

POST는 카카오톡에 메세지를 보내거나 댓글을 달거나 게시글을 작성할 때, 쇼핑을 해서 주문을 넣을 때 사용하는 메소드이다. 

PUT은 데이터를 대체하거나 없으면 생성하는 것으로 게시글을 수정할 때 사용하는 메소드이다. 

PATCH는 주로 PUT을 사용하지만 부분 변경을 할 경우 PATCH를 사용한다. 

DELETE는 말그대로 삭제하는데 사용하는 메소드이다. 

#### CRUD

CRUD는 대부분의 컴퓨터 소프트웨어가 가지는 기본적인 데이터 처리 기능인 Create(생성), Read(읽기), Update(갱신), Delete(삭제)를 묶어서 일컫는 말이다. 위의 HTTP 메서드에서는 POST, GET, PUT, DELETE가 각각 CRUD 기능 역할을 한다.

- Create: POST/PUT
- Read: GET
- Update: PUT
- Delete: DELETE

### 상태 코드

클라이언트가 서버에 요청 메세지를 보내고, 서버는 클라이언트에게 응답 메세지를 보내는데, 이때 응답 내용에 따른 **상태 코드**를 보내게 된다. 

모든 HTTP 응답 코드는 5개의 클래스(분류)로 구분된다. 상태 코드의 첫 번째 숫자는 응답의 클래스를 정의합니다. 마지막 두 자리는 클래스나 분류 역할을 하지 않는다. 첫 자리에 대한 5가지 값들은 다음과 같다.

- 1xx (정보): 요청을 받았으며 프로세스를 계속한다
- **2xx (성공)**: 요청을 성공적으로 받았으며 인식했고 수용하였다
- 3xx (리다이렉션): 요청 완료를 위해 추가 작업 조치가 필요하다
- **4xx (클라이언트 오류, 내가 잘못함)**: 요청의 문법이 잘못되었거나 요청을 처리할 수 없다 -> 잘못된 요청
- **5xx (서버 오류, 서버가 잘못함)**: 서버가 명백히 유효한 요청에 대해 충족을 실패했다 -> 서버 내부의 문제

### Request(요청) 데이터의 형태

일반적으로 GET 메소드 일때 query는 물음표 뒤에 있으며  쿼리 파라미터가 존재하여 key=value의 형태로 작성되며 &로 추가 요청(쿼리)가 가능하다. 주로 요청 메세지에서 스타트라인, 즉 상태라인, 요청라인에 쿼리 파라미터를 함께 보낸다. 물론 바디에 붙여서 보기도 한다.

> 예시
>
> https://shopping.naver.com/hotdeal/p/luckto/index.naver?id=3303424&cat=958&sort=rcnt
>
> ?id=3303424&cat=958&sort=rcnt
>
> id(key)=3303424(value)
>
> cat(key)=948(value)
>
> sort(key)=rcnt(value)

GET 메소드일 경우 쿼리 파라미터를 통한 데이터 전송을 하며 POST/PUT/PATCH 메소드를 사용하는 경우, 즉 회원가입, 게시글 작성, 게시글 업데이트(수정)할 경우에는 메세지 바디를 통해 데이터를 전송한다. 

### Response(응답) 데이터의 형태

만일 GET 요청을 하고 서버에서 데이터를 전송해주면 대부분 JSON 형태의 데이터를 보내준다. 



